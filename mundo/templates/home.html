{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
<link rel="icon" type="image/jpeg" href="{% static 'img/logo.jpg' %}">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tu Clima Mundial</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="user-info" style="font-size:0.9em; color:#94a3b8;">
    {% if user.is_authenticated %}
        Hola, <b>{{ user.username }}</b> | <a href="/logout/" style="color:#ef4444;">Salir</a>
    {% else %}
        <a href="/login/" style="color:#3b82f6;">Ingresar</a>
    {% endif %}
</div>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-image: url('{% static fondo %}');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            background-color: #1a2a3a;
            color: white;
            text-align: center;
            margin: 0;
            padding: 20px;
            box-shadow: inset 0 0 0 2000px rgba(0, 0, 0, 0.4);
            min-height: 100vh;
        }

        /* Buscador */
        .buscador { margin-bottom: 30px; }

        /* Tarjeta Principal */
        .card { 
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: inline-block; 
            padding: 30px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
            min-width: 300px; 
            max-width: 90%;
            position: relative;
        }
        
        .icono-principal { width: 120px; height: 120px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.3)); margin: 10px 0; }
        h1 { margin: 0; color: #ffcc00; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }
        h3 { color: #eee; font-weight: normal; margin-top: 5px; }
        .dato-grande { font-size: 4em; font-weight: bold; margin: 10px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .etiqueta { color: #ccc; text-transform: uppercase; font-size: 0.8em; letter-spacing: 2px; }
        .coord { font-size: 0.8em; color: #aaa; margin-top: 20px; }

        /* Carrusel Horario */
        .carrusel-horas { display: flex; overflow-x: auto; gap: 15px; padding-bottom: 20px; scrollbar-width: thin; scrollbar-color: #888 rgba(0,0,0,0.3); }
        .carrusel-horas::-webkit-scrollbar { height: 6px; }
        .carrusel-horas::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
        .carrusel-horas::-webkit-scrollbar-thumb { background-color: #888; border-radius: 10px; }
        
        .item-hora { display: flex; flex-direction: column; align-items: center; min-width: 70px; padding: 10px; border-radius: 15px; transition: 0.3s; }
        .icono-hora { width: 40px; height: 40px; margin: 5px 0; }

        .hora-destacada { 
            background: rgba(0, 210, 255, 0.2); 
            border: 2px solid #00d2ff; 
            box-shadow: 0 0 15px rgba(0, 210, 255, 0.4); 
            transform: scale(1.05);
        }

        .evento-solar { 
            background: rgba(255, 204, 0, 0.15); 
            border: 1px solid rgba(255, 204, 0, 0.6);
            min-width: 80px;
        }

        /* Calendario */
        .contenedor-dias { display: flex; overflow-x: auto; justify-content: center; gap: 15px; padding-bottom: 10px; }
        .tarjeta-dia { background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; width: 110px; cursor: pointer; transition: all 0.3s ease; }
        .tarjeta-dia:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-5px); border-color: #ffcc00; }
        .dia-activo { border: 2px solid #ffcc00; background: rgba(255, 204, 0, 0.1); box-shadow: 0 0 15px rgba(255, 204, 0, 0.3); transform: scale(1.05); }
        .icono-chico { width: 50px; height: 50px; margin: 5px 0; }
        .max { color: #ff6b6b; font-weight: bold; } .min { color: #4ecdc4; font-weight: bold; }
        
        /* Noticias */
        .contenedor-noticias { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }
        .tarjeta-noticia { background: rgba(30, 30, 30, 0.9); border-radius: 15px; width: 300px; overflow: hidden; text-align: left; transition: transform 0.3s; }
        .tarjeta-noticia:hover { transform: translateY(-5px); }
        .foto-noticia { width: 100%; height: 160px; object-fit: cover; }
        .contenido-nota { padding: 15px; }
        .btn-leer { background: transparent; border: 1px solid #00d2ff; color: #00d2ff; padding: 5px 10px; border-radius: 20px; margin-top: 10px; cursor: pointer; font-size: 0.8em; text-decoration: none; display: inline-block; }
        
        /* Estilo para la barra de scroll del Men√∫ */
        .sidebar::-webkit-scrollbar {
        width: 6px; /* Finita */
        }
        .sidebar::-webkit-scrollbar-track {
        background: #0f172a; /* Fondo oscuro */
        }
        .sidebar::-webkit-scrollbar-thumb {
        background: #334155; /* Color de la barra */
        border-radius: 10px;
        }
        .sidebar::-webkit-scrollbar-thumb:hover {
        background: #475569; /* Color al pasar el mouse */
        }

    </style>

<script type="text/javascript" src="https://cdn.weglot.com/weglot.min.js"></script>
    <script>
        Weglot.initialize({
            api_key: 'wg_169c193b22e7a117be85a2f56113ab415', // <--- TU LLAVE REAL
            hide_switcher: true,         // Oculta el bot√≥n est√°ndar (usaremos el nuestro)
            auto_switch: true            // Detecta idioma autom√°tico
        });
    </script>
</head>
<body>

{% if opciones_ciudades %}
<div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px);">
    
    <div style="background: #1e293b; border: 1px solid #334155; width: 90%; max-width: 500px; border-radius: 20px; box-shadow: 0 0 50px rgba(56, 189, 248, 0.2); overflow: hidden; animation: fadeIn 0.3s ease-out;">
        
        <div style="background: #0f172a; padding: 20px; border-bottom: 1px solid #334155; display: flex; justify-content: space-between; align-items: center;">
            <h3 style="margin: 0; color: #fff; display: flex; align-items: center; gap: 10px;">
                <svg style="width:20px; height:20px; color:#38bdf8;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                Resultados encontrados
            </h3>
            <button onclick="this.closest('div').parentElement.parentElement.style.display='none'" style="background: none; border: none; color: #64748b; font-size: 1.5em; cursor: pointer;">&times;</button>
        </div>

        <div style="max-height: 60vh; overflow-y: auto; padding: 10px;">
            <p style="color: #94a3b8; font-size: 0.9em; padding: 0 10px; margin-bottom: 15px;">
                Hemos encontrado varias ubicaciones para tu b√∫squeda. Por favor, selecciona la correcta:
            </p>

            {% for ciudad in opciones_ciudades %}
            <a href="/?lat={{ ciudad.latitude }}&lon={{ ciudad.longitude }}" style="text-decoration: none;">
                <div class="item-ciudad" style="display: flex; align-items: center; gap: 15px; padding: 15px; border-radius: 10px; transition: 0.2s; border-bottom: 1px solid rgba(255,255,255,0.05); margin-bottom: 5px;">
                    
                    {% if ciudad.country_code %}
                    <img src="https://flagcdn.com/w40/{{ ciudad.country_code|lower }}.png" style="width: 25px; border-radius: 4px; box-shadow: 0 0 5px rgba(0,0,0,0.5);">
                    {% else %}
                    <span style="font-size: 1.5em;">üåç</span>
                    {% endif %}

                    <div style="flex: 1;">
                        <div style="color: #fff; font-weight: 700; font-size: 1.1em;">{{ ciudad.name }}</div>
                        <div style="color: #94a3b8; font-size: 0.85em;">
                            {{ ciudad.admin1|default:"" }} {% if ciudad.admin1 %}|{% endif %} {{ ciudad.country }}
                        </div>
                    </div>
                    
                    <svg style="width:18px; height:18px; color: #38bdf8;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</div>

<style>
    .item-ciudad:hover {
        background: rgba(56, 189, 248, 0.1);
        transform: translateX(5px);
    }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
</style>
{% endif %}


<div id="google_translate_element" style="display:none;"></div>

<script type="text/javascript">
    function googleTranslateElementInit() {
        new google.translate.TranslateElement({
            pageLanguage: 'es', 
            includedLanguages: 'en,fr,it,pt,de', // Idiomas permitidos
            autoDisplay: false
        }, 'google_translate_element');
    }
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script type="text/javascript">
    window.addEventListener('load', function() {
        // A. Detectamos el idioma del navegador del usuario (ej: 'en-US' o 'pt-BR')
        var idiomaUsuario = navigator.language || navigator.userLanguage; 
        idiomaUsuario = idiomaUsuario.split('-')[0]; // Nos quedamos solo con las dos letras ('en', 'pt', etc.)

        // B. Si el usuario NO habla espa√±ol, activamos la traducci√≥n
        if (idiomaUsuario !== 'es') {
            
            // Esperamos un segundo a que Google cargue en el fondo
            setTimeout(function() {
                var select = document.querySelector('select.goog-te-combo');
                if (select) {
                    select.value = idiomaUsuario; // Seleccionamos su idioma
                    select.dispatchEvent(new Event('change')); // ¬°Clic virtual!
                }
            }, 1000); // 1000ms = 1 segundo de espera
        }
    });
</script>

<style>
    .goog-te-banner-frame { display: none !important; }
    body { top: 0px !important; }
    #google_translate_element { display: none !important; }
</style>

<div style="position: fixed; top: 20px; left: 20px; z-index: 10000; display: flex; align-items: center; gap: 15px;">
        
        <button onclick="toggleMenu()" style="
            background: rgba(0, 0, 0, 0.6); 
            backdrop-filter: blur(5px);
            border: 1px solid rgba(0, 210, 255, 0.5); 
            color: #00d2ff; 
            font-size: 1.5em; 
            padding: 10px 15px; 
            border-radius: 10px; 
            cursor: pointer; 
            transition: 0.3s;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);">
            ‚ò∞
        </button>

{% if user.is_authenticated and user.perfil.suscripcion_activa %}
    <div style="
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(5px);
        padding: 10px 20px;
        border-radius: 30px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        font-weight: bold;
        color: #fff;
        display: flex; align-items: center; gap: 10px;
        box-shadow: 0 0 15px rgba(0,0,0,0.5);">
        
        <div style="width: 10px; height: 10px; background: #00d2ff; border-radius: 50%; box-shadow: 0 0 10px #00d2ff;"></div>
        CLIMA <span style="color: #ffcc00;">PRO</span>
    </div>
{% endif %} </div>

    <div id="miSidebar" style="
        position: fixed; 
        top: 0; 
        left: -300px; /* Oculto a la izquierda */
        width: 280px; 
        height: 100%;
        overflow-y: auto; 
        background: rgba(15, 20, 35, 0.95); /* Color oscuro profundo */
        backdrop-filter: blur(20px); 
        border-right: 1px solid rgba(0, 210, 255, 0.3);
        box-shadow: 5px 0 30px rgba(0,0,0,0.8);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); /* Animaci√≥n suave */
        z-index: 10001; 
        padding: 30px; 
        text-align: left;
        display: flex;
        flex-direction: column;">

        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px;">
    <span style="color: #fff; font-size: 1.1em; font-weight: 800; letter-spacing: 1px; text-transform: uppercase;">Navegaci√≥n</span>
    <button onclick="toggleMenu()" style="background: transparent; border: none; color: #94a3b8; font-size: 1.2em; cursor: pointer; transition: 0.2s;" onmouseover="this.style.color='#fff'">‚úï</button>
</div>

<div style="display: flex; flex-direction: column; gap: 8px;">
    
    <a href="/" style="text-decoration: none; color: #fff; padding: 12px 15px; border-radius: 8px; background: rgba(56, 189, 248, 0.1); border-left: 3px solid #38bdf8; display: flex; align-items: center; gap: 12px; transition: 0.2s;">
        <svg style="width:18px; height:18px; color:#38bdf8;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
        <span style="font-weight: 600; font-size: 0.9em;">Inicio / General</span>
    </a>

    <div style="color: #64748b; font-size: 0.75em; margin-top: 15px; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; padding-left: 10px;">Modos Profesionales</div>

    <a href="/agro?lat={{ lat }}&lon={{ lon }}" class="btn-menu" style="text-decoration: none; color: #cbd5e1; padding: 10px 15px; border-radius: 8px; transition: 0.2s; display: flex; align-items: center; gap: 12px;" onmouseover="this.style.background='rgba(255,255,255,0.05)'; this.style.color='#fff';" onmouseout="this.style.background='transparent'; this.style.color='#cbd5e1';">
        <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 6.5-5.2 14.6l-3.3 2.6C13.5 18.3 8 15 4 10"></path></svg>
        <span style="font-size: 0.9em;">Modo Agro</span>
    </a>
    
    <a href="/naval?lat={{ lat }}&lon={{ lon }}" class="btn-menu" style="text-decoration: none; color: #cbd5e1; padding: 10px 15px; border-radius: 8px; transition: 0.2s; display: flex; align-items: center; gap: 12px;" onmouseover="this.style.background='rgba(255,255,255,0.05)'; this.style.color='#fff';" onmouseout="this.style.background='transparent'; this.style.color='#cbd5e1';">
        <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="5" r="3"></circle><line x1="12" y1="22" x2="12" y2="8"></line><path d="M5 12H2a10 10 0 0 0 20 0h-3"></path></svg>
        <span style="font-size: 0.9em;">Modo Naval</span>
    </a>
    
    <a href="/aereo?lat={{ lat }}&lon={{ lon }}" class="btn-menu" style="text-decoration: none; color: #cbd5e1; padding: 10px 15px; border-radius: 8px; transition: 0.2s; display: flex; align-items: center; gap: 12px;" onmouseover="this.style.background='rgba(255,255,255,0.05)'; this.style.color='#fff';" onmouseout="this.style.background='transparent'; this.style.color='#cbd5e1';">
    <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.3c.4-.2.6-.6.5-1.1z"/>
    </svg>
    <span style="font-size: 0.9em;">Modo A√©reo</span>
</a>
    
    <a href="/energia?lat={{ lat }}&lon={{ lon }}" class="btn-menu" style="text-decoration: none; color: #cbd5e1; padding: 10px 15px; border-radius: 8px; transition: 0.2s; display: flex; align-items: center; gap: 12px;" onmouseover="this.style.background='rgba(255,255,255,0.05)'; this.style.color='#fff';" onmouseout="this.style.background='transparent'; this.style.color='#cbd5e1';">
        <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
        <span style="font-size: 0.9em;">Modo Energ√≠as</span>
    </a>

    <div style="color: #64748b; font-size: 0.75em; margin-top: 15px; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; padding-left: 10px;">Ciencia</div>

    <a href="/mapas/" style="text-decoration: none; color: #38bdf8; padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(56, 189, 248, 0.2); display: flex; align-items: center; gap: 12px; transition: 0.2s; background: rgba(56, 189, 248, 0.05);" onmouseover="this.style.background='rgba(56, 189, 248, 0.15)'" onmouseout="this.style.background='rgba(56, 189, 248, 0.05)';">
        <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon><line x1="8" y1="2" x2="8" y2="18"></line><line x1="16" y1="6" x2="16" y2="22"></line></svg>
        <span style="font-weight: 600; font-size: 0.9em;">Mapas & Radar</span>
    </a>

    <a href="/ciencia/" style="text-decoration: none; color: #a5b4fc; padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(165, 180, 252, 0.2); display: flex; align-items: center; gap: 12px; transition: 0.2s; background: rgba(165, 180, 252, 0.05);" onmouseover="this.style.background='rgba(165, 180, 252, 0.15)'" onmouseout="this.style.background='rgba(165, 180, 252, 0.05)';">
        <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path d="M6 12v5c3 3 9 3 12 0v-5"></path></svg>
        <span style="font-weight: 600; font-size: 0.9em;">Papers & ArXiv</span>
    </a>
    
<a href="/comparador/?lat={{ lat }}&lon={{ lon }}&ciudad={{ ciudad }}" style="padding: 15px 20px; text-decoration: none; font-size: 18px; color: #e2e8f0; display: flex; align-items: center; gap: 15px; transition: 0.3s; border-left: 3px solid transparent;" onmouseover="this.style.background='rgba(56, 189, 248, 0.1)'; this.style.borderLeft='3px solid #38bdf8'; this.style.color='#38bdf8'" onmouseout="this.style.background='transparent'; this.style.borderLeft='3px solid transparent'; this.style.color='#e2e8f0'">
    
    <svg style="width: 24px; height: 24px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 3v18h18"></path>
        <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"></path>
    </svg>
    
    <div>
        <div style="font-weight: 600;">Comparador Cient√≠fico</div>
        <div style="font-size: 0.7em; color: #94a3b8;">GFS vs ARPEGE vs ICON</div>
    </div>
</a>

<a href="{% url 'espacio' %}" style="display: flex; align-items: center; gap: 10px; color: #e2e8f0; text-decoration: none; padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); transition: 0.3s;">
    <div style="background: linear-gradient(135deg, #667eea, #764ba2); width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 10px #764ba2;">
        <svg style="width:20px; height:20px; color:white;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="M4.93 4.93l1.41 1.41"/><path d="M17.66 17.66l1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="M6.34 17.66l-1.41 1.41"/><path d="M19.07 4.93l-1.41 1.41"/></svg>
    </div>
    <span style="font-weight: 600; font-family: 'Segoe UI', sans-serif;">Meteorolog√≠a Espacial</span>
</a>

    <a href="/ayuda/" style="display: flex; align-items: center; gap: 12px; padding: 12px 15px; color: #94a3b8; text-decoration: none; border-radius: 8px; transition: 0.2s; margin-top: 10px;" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#94a3b8'">
        <svg style="width:18px; height:18px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
        <span style="font-size: 0.9em;">Centro de Ayuda</span>
    </a>

<div class="sidebar-section" style="margin-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
    
    <div style="font-size: 0.75em; color: #64748b; margin-bottom: 10px; padding-left: 20px; font-family: 'Orbitron'; letter-spacing: 1px;">
        CONFIGURACI√ìN
    </div>

    <div class="sidebar-link" onclick="toggleSidebarLang()" style="cursor: pointer; display: flex; align-items: center; padding: 12px 20px; color: #94a3b8; transition: 0.3s;">
        <svg style="width:20px; height:20px; margin-right: 15px; color:#38bdf8;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
        
        <span style="font-family: 'Segoe UI', sans-serif;">Idioma / Language</span>
        
        <svg id="lang-arrow" style="width:14px; height:14px; margin-left: auto; transition: 0.3s;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
    </div>

    <div id="sidebar-lang-list" style="display: none; background: rgba(0,0,0,0.3); margin: 5px 15px; border-radius: 8px; overflow: hidden;">
        
        <a href="#" onclick="Weglot.switchTo('es'); return false;" class="sl-item">
            <img src="https://flagcdn.com/w20/ar.png" width="20" style="margin-right:10px; opacity:0.8;"> 
            Espa√±ol
        </a>
        
        <a href="#" onclick="Weglot.switchTo('en'); return false;" class="sl-item">
            <img src="https://flagcdn.com/w20/us.png" width="20" style="margin-right:10px; opacity:0.8;"> 
            English
        </a>

    </div>
</div>

<script type="text/javascript" src="https://cdn.weglot.com/weglot.min.js"></script>
<script>
    // 1. INICIALIZAR MOTOR
    Weglot.initialize({
        api_key: 'wg_169c193b22e7a117be85a2f56113ab415', // Tu clave real
        hide_switcher: true,
        auto_switch: false 
    });

    // 2. FUNCI√ìN VISUAL DEL MEN√ö
    function toggleSidebarLang() {
        const list = document.getElementById('sidebar-lang-list');
        const arrow = document.getElementById('lang-arrow');
        
        if (list.style.display === 'none') {
            list.style.display = 'block';
            arrow.style.transform = 'rotate(180deg)';
        } else {
            list.style.display = 'none';
            arrow.style.transform = 'rotate(0deg)';
        }
    }
</script>

<style>
    .sl-item {
        display: flex; align-items: center;
        padding: 12px 20px;
        color: #cbd5e1; text-decoration: none; font-size: 0.9em;
        font-family: 'Segoe UI', sans-serif;
        border-bottom: 1px solid rgba(255,255,255,0.02);
        transition: 0.2s;
    }
    .sl-item:hover {
        background: rgba(56, 189, 248, 0.1);
        color: #38bdf8;
        padding-left: 25px;
    }
</style>




</div>

<div style="margin-top: auto; font-size: 0.7em; color: #475569; text-align: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
    <div style="font-weight: 700; letter-spacing: 1px;">FLIGHT DECK PRO</div>
    <div style="margin-top: 5px;">v2.0 Stable ‚Ä¢ UBA</div>
</div>

</div> 

    <script>
        function toggleMenu() {
            const sidebar = document.getElementById('miSidebar');
            if (sidebar.style.left === '0px') {
                sidebar.style.left = '-300px'; // Cerrar
            } else {
                sidebar.style.left = '0px'; // Abrir
            }
        }
    </script>

    <div style="height: 80px;"></div>    
    
    <div class="buscador" style="display: flex; justify-content: center; gap: 15px; align-items: center; margin-bottom: 40px;">
        <form action="" method="get" style="display: flex; gap: 10px; align-items: center;">
            <input type="text" name="ciudad" placeholder="Buscar ciudad..." required style="padding: 15px 25px; width: 250px; border-radius: 30px; border: 2px solid rgba(0, 210, 255, 0.5); outline: none; text-align: center; font-size: 1.2em; background: rgba(0, 0, 0, 0.5); color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.5); transition: all 0.3s ease;">

            <button type="submit" style="background: rgba(0, 0, 0, 0.7); border: 3px solid #00d2ff; width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 0 15px rgba(0, 210, 255, 0.4), inset 0 0 10px rgba(0, 210, 255, 0.2); transition: all 0.3s ease;" title="Buscar">
                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="#00d2ff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" style="filter: drop-shadow(0 0 5px #00d2ff);"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            </button>
        </form>
        <button onclick="usarGPS()" style="background: rgba(0, 0, 0, 0.7); border: 3px solid #00d2ff; width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 0 15px rgba(0, 210, 255, 0.4), inset 0 0 10px rgba(0, 210, 255, 0.2); transition: all 0.3s ease;" title="Actualizar Ubicaci√≥n">
            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="#00d2ff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" style="filter: drop-shadow(0 0 5px #00d2ff);"><path d="M23 4v6h-6"></path><path d="M1 20v-6h6"></path><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
        </button>
    </div>
<div style="display: flex; justify-content: center; gap: 10px; align-items: center; margin-bottom: 40px;">
    <form method="get" style="display: flex; gap: 10px; align-items: center;">
        <input type="number" step="any" name="lat" placeholder="Lat (Ej: -34.5)" required 
               style="padding: 12px 15px; width: 140px; border-radius: 30px; border: 2px solid #00d2ff; background: rgba(0, 0, 0, 0.5); color: white; outline: none; text-align: center;">
        
        <input type="number" step="any" name="lon" placeholder="Lon (Ej: -58.5)" required 
               style="padding: 12px 15px; width: 140px; border-radius: 30px; border: 2px solid #00d2ff; background: rgba(0, 0, 0, 0.5); color: white; outline: none; text-align: center;">
        
        <button type="submit" style="background: #00d2ff; border: none; padding: 12px 20px; border-radius: 30px; cursor: pointer; font-weight: bold; color: #000; transition: 0.3s;">
            IR 
        </button>
    </form>
</div>

    <script>
        window.onload = function() {
            if (window.location.search === "") {
                usarGPS();
            }
        };

        function usarGPS() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    const urlParams = new URLSearchParams(window.location.search);
                    const latActual = urlParams.get('lat');
                    if (!latActual) {
                        window.location.href = `/?lat=${lat}&lon=${lon}`;
                    }
                }, function(error) { console.log("GPS no disponible"); });
            }
        }
    </script>

    <div class="card">
        <h3>El clima en:</h3>
        <h1>{{ ciudad }}</h1>
        <p style="font-size: 1.1em; color: #ddd;">{{ pais }}</p>
        <div style="background: rgba(0,0,0,0.4); display: inline-block; padding: 5px 15px; border-radius: 20px; margin-top: 5px; border: 1px solid rgba(255,255,255,0.2);">
             Hora local: <span style="color: #ffcc00; font-weight: bold;">{{ hora_local|date:"H:i" }}</span>
        </div>
        <hr style="border-color: #aaa; opacity: 0.3; margin-top: 15px;">
        <img src="{{ icono }}" class="icono-principal">
        <h2 style="color: #00d2ff; margin-top: -10px; margin-bottom: 20px;">{{ descripcion }}</h2>
        <div style="margin-bottom: 20px;">
            <div class="etiqueta" style="margin-bottom: 5px;">TEMPERATURA ACTUAL</div>
            <div class="dato-grande" data-wg-notranslate style="line-height: 1;">{{ temp }}¬∞C</div>
        </div>
        
        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; margin: 20px 0; display: flex; justify-content: space-around; align-items: center; border: 1px solid rgba(255,255,255,0.1);">
            <div style="text-align: center;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/thermometer.svg" style="width: 35px; height: 35px; margin-bottom: 5px;">
                <div style="font-size: 0.7em; color: #ddd;">SENSACI√ìN</div>
                <div style="font-weight: bold; font-size: 1.2em; color: #ffcc00;">{{ sensacion }}¬∞</div>
            </div>
            <div style="width: 1px; height: 40px; background: rgba(255,255,255,0.2);"></div>
            <div style="text-align: center;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/humidity.svg" style="width: 35px; height: 35px; margin-bottom: 5px;">
                <div style="font-size: 0.7em; color: #ddd;">HUMEDAD</div>
                <div style="font-weight: bold; font-size: 1.2em; color: #00d2ff;">{{ humedad }}%</div>
            </div>
            <div style="width: 1px; height: 40px; background: rgba(255,255,255,0.2);"></div>
            <div style="text-align: center;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/raindrops.svg" style="width: 35px; height: 35px; margin-bottom: 5px;">
                <div style="font-size: 0.7em; color: #ddd;">LLUVIA</div>
                <div style="font-weight: bold; font-size: 1.2em; color: #fff;">{{ lluvia_hoy }}mm</div>
            </div>
        </div>

        <div style="background: rgba(0,0,0,0.3); padding: 10px 20px; border-radius: 15px; margin: 15px 0; display: inline-flex; gap: 40px; align-items: center;">
            <div style="text-align: center;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/sunrise.svg" style="width: 50px; height: 50px; margin-bottom: 5px;">
                <div style="font-size: 0.8em; color: #ddd;">AMANECER</div>
                <div style="font-weight: bold; color: #ffcc00;">{{ sunrise }}</div>
            </div>
            <div style="text-align: center;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/sunset.svg" style="width: 50px; height: 50px; margin-bottom: 5px;">
                <div style="font-size: 0.8em; color: #ddd;">ATARDECER</div>
                <div style="font-weight: bold; color: #ff6b6b;">{{ sunset }}</div>
            </div>
        </div>

        <div class="etiqueta">VIENTO</div>
    
    <div style="font-size: 1.5em; display: flex; align-items: center; justify-content: center; gap: 10px;">
        <svg style="width:28px; height:28px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"/></svg>
        {{ viento }} km/h
    </div>
    
    <p class="coord">Lat: {{ lat }} | Lon: {{ lon }}</p>
</div>

<br><br>

<h2 style="color: #eee; text-shadow: 1px 1px 2px black; display: flex; align-items: center; justify-content: center; gap: 10px;">
    <svg style="width:24px; height:24px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
    Calendario de Pron√≥stico
</h2>

<div class="contenedor-dias" id="listaDias">
    {% for dia in pronostico %}
    <div class="tarjeta-dia {% if forloop.first %}dia-activo{% endif %}" 
         onclick="cambiarDia('{{ dia.fecha_full }}', '{{ dia.nombre_dia }}', '{{ dia.fecha_corta }}', this)">
        <div style="font-weight: bold; font-size: 0.9em; margin-bottom: 5px;">{{ dia.nombre_dia }}</div>
        <div class="fecha" style="font-size: 0.8em; color: #ccc;">{{ dia.fecha_corta }}</div>
        <img src="{{ dia.icono }}" class="icono-chico">
        <div class="temp-rango">
            <span class="max">{{ dia.max }}¬∞</span> 
            <span class="min">{{ dia.min }}¬∞</span>
        </div>
    </div>
    {% endfor %}
</div>

    <br>

    <div style="width: 90%; max-width: 800px; margin: 0 auto; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.5);">
        <h3 id="tituloHoras" style="color: #00d2ff; margin-bottom: 15px;">Pron√≥stico por Horas (HOY)</h3>
        
        <div class="carrusel-horas" id="carruselHoras">
            {% for h in tira_horas %}
            {% if h.tipo == 'evento' %}
            <div class="item-hora evento-solar">
                <span style="color: #fff; font-weight: bold; font-size: 0.9em;">{{ h.hora }}</span>
                <img src="{{ h.icono }}" class="icono-hora" style="width: 50px; height: 50px;">
                <span style="color: #ffcc00; font-weight: bold; font-size: 0.7em; margin-top: 5px;">{{ h.evento_titulo }}</span>
            </div>
            {% else %}
            <div class="item-hora {% if h.es_actual %}hora-destacada{% endif %}">
                <span style="color: #ccc; font-size: 0.8em;">{{ h.hora }}</span>
                <img src="{{ h.icono }}" class="icono-hora">
                <span style="color: #ffcc00; font-weight: bold;">{{ h.temp }}¬∞</span>
                
                <span style="font-size: 0.7em; color: #4ecdc4; margin-top: 2px; display: flex; align-items: center; justify-content: center; gap: 3px;">
                    <svg style="width:10px; height:10px;" viewBox="0 0 24 24" fill="currentColor" stroke="none">
                        <path d="M12 2.69l5.74 5.82a7 7 0 0 1 0 9.88l-5.74 5.81l-5.74-5.81a7 7 0 0 1 0-9.88Z"/>
                    </svg>
                    {{ h.lluvia }}%
                </span>

                {% if h.es_actual %}
                <div style="font-size: 0.6em; color: #00d2ff; font-weight: bold; margin-top: 5px;">AHORA</div>
                {% endif %}
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <canvas id="graficoHoras" style="margin-top: 20px;"></canvas>
    </div>

    <br><br><hr style="border-color: #aaa; margin: 40px 0; opacity: 0.5;">

    <h2 style="color: #ffcc00; text-align: left; margin-left: 20px; text-shadow: 1px 1px 2px black; display: flex; align-items: center; gap: 10px;">
        <svg style="width:28px; height:28px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
        </svg>
        Detalles y Precauciones
    </h2>
    
    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 0 20px;">
        
        <div style="background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 20px; width: 250px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/clear-day.svg" style="width: 30px; height: 30px;">
                <div style="color: #ccc; font-size: 0.9em;">√çNDICE UV M√ÅXIMO</div>
            </div>
            <div style="font-size: 2.5em; font-weight: bold; color: {% if uv_index > 7 %}#ff4757{% elif uv_index > 4 %}#ffa502{% else %}#2ed573{% endif %};">
                {{ uv_index }}
            </div>
            
            <div style="font-size: 0.8em; color: #ddd; display: flex; align-items: center; gap: 6px;">
                {% if uv_index > 10 %}Extremo 
                    <svg style="width:16px; height:16px; color:#ff4757;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2"></polygon><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                {% elif uv_index > 7 %}Muy Alto 
                    <svg style="width:16px; height:16px; color:#ff4757;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                {% elif uv_index > 5 %}Alto 
                    <svg style="width:16px; height:16px; color:#ffa502;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                {% elif uv_index > 2 %}Moderado 
                    <svg style="width:16px; height:16px; color:#ffa502;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="8" y1="12" x2="16" y2="12"></line></svg>
                {% else %}Bajo 
                    <svg style="width:16px; height:16px; color:#2ed573;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                {% endif %}
            </div>

            <div style="width: 100%; height: 5px; background: #333; margin-top: 10px; border-radius: 5px;">
                <div style="width: {{ uv_index|make_list|length|add:uv_index|add:0 }}0%; max-width: 100%; height: 100%; background: linear-gradient(90deg, #2ed573, #ffa502, #ff4757); border-radius: 5px;"></div>
            </div>
        </div>

        <div style="background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 20px; width: 250px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/cloudy.svg" style="width: 30px; height: 30px;">
                <div style="color: #ccc; font-size: 0.9em;">FORMACI√ìN DE NUBES</div>
            </div>
            <div style="font-size: 1.2em; font-weight: bold; color: #fff; margin-bottom: 5px;">{{ tipo_nube }}</div>
            <div style="font-size: 0.8em; color: #aaa;">Observaci√≥n Satelital</div>
            <div style="margin-top: 10px; text-align: right;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/overcast.svg" style="width: 50px; height: 50px; opacity: 0.8;">
            </div>
        </div>

        <div style="background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 20px; width: 250px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/fog.svg" style="width: 25px; height: 25px;">
                <div style="color: #ccc; font-size: 0.9em;">VISIBILIDAD</div>
            </div>
            <div style="font-size: 1.5em; font-weight: bold; color: #fff;">{{ visibilidad }} km</div>
            <hr style="border-color: #444; margin: 10px 0;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                <img src="https://bmcdn.nl/assets/weather-icons/v3.0/fill/svg/hurricane.svg" style="width: 25px; height: 25px;">
                <div style="color: #ccc; font-size: 0.9em;">PRESI√ìN</div>
            </div>
            <div style="font-size: 1.5em; font-weight: bold; color: #00d2ff;">{{ presion }} hPa</div>
        </div>

        <div style="background: rgba(0,0,0,0.4); border: 2px solid {{ alerta_color }}; padding: 25px 20px; border-radius: 20px; width: 250px; text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 0 20px {{ alerta_color }}40;">
    
    <div style="color: {{ alerta_color }}; margin-bottom: 15px;">
        
        {% if alerta_tipo == 'tormenta' %}
            <svg style="width:60px; height:60px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>
        
        {% elif alerta_tipo == 'nieve' %}
            <svg style="width:60px; height:60px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="2" x2="12" y2="22"></line><line x1="12" y1="2" x2="12.01" y2="2"></line><line x1="12" y1="22" x2="12.01" y2="22"></line><line x1="20.66" y1="7" x2="3.34" y2="17"></line><line x1="20.66" y1="7" x2="20.67" y2="7"></line><line x1="3.34" y1="17" x2="3.35" y2="17"></line><line x1="20.66" y1="17" x2="3.34" y2="7"></line><line x1="20.66" y1="17" x2="20.67" y2="17"></line><line x1="3.34" y1="7" x2="3.35" y2="7"></line></svg>
        
        {% elif alerta_tipo == 'lluvia' %}
            <svg style="width:60px; height:60px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="16" y1="13" x2="16" y2="21"></line><line x1="8" y1="13" x2="8" y2="21"></line><line x1="12" y1="15" x2="12" y2="23"></line><path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25"></path></svg>
        
        {% elif alerta_tipo == 'niebla' %}
            <svg style="width:60px; height:60px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"></path><path d="M4 18h16"></path><path d="M6 6h12"></path></svg>
        
        {% elif alerta_tipo == 'calor' %}
            <svg style="width:60px; height:60px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/><path d="M12 2v2"/><path d="M12 14v.01"/></svg>
        
        {% else %}
            <svg style="width:60px; height:60px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
        {% endif %}
        
    </div>

    <div style="color: {{ alerta_color }}; font-weight: 800; font-size: 0.85em; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 1px;">
        PRECAUCI√ìN SUGERIDA
    </div>
    
    <div style="color: #fff; font-weight: 600; font-size: 1em; line-height: 1.4;">
        {{ alerta_texto }}
    </div>
</div>

<div style="background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); padding: 20px; border-radius: 20px; width: 250px; text-align: left; position: relative; overflow: hidden;">
    
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
        <svg style="width: 24px; height: 24px; color: #cbd5e1;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/><path d="M12 2v2"/><path d="M12 14v.01"/><path d="M20 10h2"/><path d="M20 14h2"/><path d="M2 10h2"/><path d="M2 14h2"/></svg>
        <div style="color: #ccc; font-size: 0.8em; font-weight: 800; letter-spacing: 1px; text-transform: uppercase;">ANOMAL√çA CLIM√ÅTICA</div>
    </div>

    {% if delta_temp > 1.5 %}
        <div style="display: flex; align-items: center; gap: 8px;">
            <svg style="width:32px; height:32px; color: #ff4757; filter: drop-shadow(0 0 8px rgba(255, 71, 87, 0.5));" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
            <div style="font-size: 2.2em; font-weight: 800; color: #ff4757; text-shadow: 0 0 15px rgba(255, 71, 87, 0.3);">
                +{{ delta_temp }}¬∞C
            </div>
        </div>
        <div style="font-size: 0.9em; color: #ff4757; font-weight: 600; margin-top: 5px;">Sobre el promedio hist√≥rico.</div>
        
        <div style="position: absolute; right: -20px; bottom: -20px; opacity: 0.1; color: #ff4757;">
            <svg style="width:100px; height:100px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><path d="M12 2v2"/><path d="M12 14v.01"/><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>
        </div>

    {% elif delta_temp < -1.5 %}
        <div style="display: flex; align-items: center; gap: 8px;">
            <svg style="width:32px; height:32px; color: #38bdf8; filter: drop-shadow(0 0 8px rgba(56, 189, 248, 0.5));" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>
            <div style="font-size: 2.2em; font-weight: 800; color: #38bdf8; text-shadow: 0 0 15px rgba(56, 189, 248, 0.3);">
                {{ delta_temp }}¬∞C
            </div>
        </div>
        <div style="font-size: 0.9em; color: #38bdf8; font-weight: 600; margin-top: 5px;">Bajo el promedio hist√≥rico.</div>
        
        <div style="position: absolute; right: -20px; bottom: -20px; opacity: 0.1; color: #38bdf8;">
            <svg style="width:100px; height:100px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><line x1="12" y1="2" x2="12" y2="22"></line><line x1="20.66" y1="7" x2="3.34" y2="17"></line><line x1="20.66" y1="17" x2="3.34" y2="7"></line></svg>
        </div>

    {% else %}
        <div style="display: flex; align-items: center; gap: 8px;">
            <svg style="width:32px; height:32px; color: #2ed573; filter: drop-shadow(0 0 8px rgba(46, 213, 115, 0.5));" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
            <div style="font-size: 2.2em; font-weight: 800; color: #2ed573; text-shadow: 0 0 15px rgba(46, 213, 115, 0.3);">
                {{ delta_temp }}¬∞C
            </div>
        </div>
        <div style="font-size: 0.9em; color: #2ed573; font-weight: 600; margin-top: 5px;">Dentro del rango normal.</div>
    {% endif %}

    <div style="font-size: 0.7em; color: #64748b; margin-top: 15px; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 8px;">
        Comparativa: Promedio de los ultimos 3 a√±os.
    </div>
</div>

    </div>

    <br><br><hr style="border-color: #aaa; margin: 40px 0; opacity: 0.5;">
    
    <h2 style="color: #ffcc00; text-align: left; margin-left: 20px; text-shadow: 1px 1px 2px black; display: flex; align-items: center; gap: 10px;">
        <svg style="width:28px; height:28px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"/><path d="M18 14h-8"/><path d="M15 18h-5"/><path d="M10 6h8v4h-8V6Z"/></svg>
        Alertas y Noticias Globales
    </h2>
    
    <div class="contenedor-noticias">
        {% for nota in noticias %}
        <div class="tarjeta-noticia">
            <img src="{{ nota.imagen }}" class="foto-noticia">
            <div class="contenido-nota">
                <div class="cat-nota">{{ nota.categoria }}</div>
                <h3>{{ nota.titulo }}</h3>
                <p>{{ nota.resumen }}</p>
                <a href="{{ nota.link }}" target="_blank" class="btn-leer">Leer m√°s</a>
            </div>
        </div>
        {% endfor %}
    </div>

    <script>
        const datosSemana = JSON.parse('{{ datos_json|safe }}');
        let labelsIniciales = {{ horas_grafico|safe }};
        let tempsIniciales = {{ temps_grafico|safe }};
        
        const ctx = document.getElementById('graficoHoras');
        let chartInstance = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labelsIniciales, 
                datasets: [{
                    label: 'Temperatura (¬∞C)',
                    data: tempsIniciales,
                    borderWidth: 3,
                    borderColor: '#ffcc00',
                    backgroundColor: 'rgba(255, 204, 0, 0.2)',
                    tension: 0.4,
                    pointRadius: 0,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    x: { ticks: { color: '#ccc' }, grid: { display: false } },
                    y: { ticks: { color: '#ccc' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                }
            }
        });

        function cambiarDia(fechaFull, nombreDia, fechaCorta, elementoClick) {
            document.querySelectorAll('.tarjeta-dia').forEach(el => el.classList.remove('dia-activo'));
            elementoClick.classList.add('dia-activo');
            document.getElementById('tituloHoras').innerText = `Pron√≥stico por Horas (${nombreDia} ${fechaCorta})`;

            const datosDelDia = datosSemana[fechaFull];
            
            if (datosDelDia) {
                const contenedor = document.getElementById('carruselHoras');
                contenedor.innerHTML = '';
                
                let nuevosLabels = [];
                let nuevasTemps = [];

                datosDelDia.forEach(h => {
                    if (h.tipo === 'normal') {
                        nuevosLabels.push(h.hora);
                        nuevasTemps.push(h.temp);
                    }

                    let htmlHora = '';
                    if (h.tipo === 'evento') {
                        htmlHora = `
                            <div class="item-hora evento-solar">
                                <span style="color: #fff; font-weight: bold; font-size: 0.9em;">${h.hora}</span>
                                <img src="${h.icono}" class="icono-hora" style="width: 50px; height: 50px;">
                                <span style="color: #ffcc00; font-weight: bold; font-size: 0.7em; margin-top: 5px;">${h.evento_titulo}</span>
                            </div>
                        `;
                    } else {
                        let claseExtra = h.es_actual ? 'hora-destacada' : '';
                        let etiquetaAhora = h.es_actual ? '<div style="font-size: 0.6em; color: #00d2ff; font-weight: bold; margin-top: 5px;">AHORA</div>' : '';
                        htmlHora = `
                            <div class="item-hora ${claseExtra}">
                                <span style="color: #ccc; font-size: 0.8em;">${h.hora}</span>
                                <img src="${h.icono}" class="icono-hora">
                                <span style="color: #ffcc00; font-weight: bold;">${h.temp}¬∞</span>
                                <span style="font-size: 0.7em; color: #4ecdc4; margin-top: 2px;">üíß${h.lluvia}%</span>
                                ${etiquetaAhora}
                            </div>
                        `;
                    }
                    contenedor.innerHTML += htmlHora;
                });

                chartInstance.data.labels = nuevosLabels;
                chartInstance.data.datasets[0].data = nuevasTemps;
                chartInstance.update();
            }
        }
    </script>
<br><br><hr style="border-color: #aaa; margin: 40px 0; opacity: 0.3;">

    <h2 id="papers" style="color: #a29bfe; text-align: left; margin-left: 20px; text-shadow: 1px 1px 2px black; display: flex; align-items: center; gap: 10px;">
        <svg style="width:32px; height:32px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path d="M6 12v5c3 3 9 3 12 0v-5"></path></svg>
        Papers y Publicaciones Cient√≠ficas
        <span style="font-size: 0.5em; background: #6c5ce7; padding: 2px 8px; border-radius: 10px; color: white;">ArXiv API</span>
    </h2>
    
    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px;">
        {% for paper in papers %}
        <div style="background: rgba(10, 10, 20, 0.8); border-left: 4px solid #a29bfe; padding: 20px; border-radius: 10px; width: 350px; text-align: left; transition: transform 0.3s;">
            <div style="font-size: 0.8em; color: #a29bfe; margin-bottom: 5px;">{{ paper.fecha }} | {{ paper.autor }}</div>
            <h4 style="margin: 5px 0; color: #eee; line-height: 1.4;">{{ paper.titulo }}</h4>
            <p style="font-size: 0.85em; color: #aaa; height: 60px; overflow: hidden; text-overflow: ellipsis;">{{ paper.resumen }}</p>
            
            <a href="{{ paper.link }}" target="_blank" style="text-decoration: none; color: #fff; background: #6c5ce7; padding: 5px 15px; border-radius: 20px; font-size: 0.8em; display: inline-flex; align-items: center; gap: 6px; margin-top: 10px;">
                <svg style="width:14px; height:14px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
                Leer PDF Completo
            </a>

        </div>
        {% endfor %}
    </div>
    <br><br>
    
    <footer style="background: rgba(0,0,0,0.8); padding: 20px; color: #555; font-size: 0.8em;">
        Desarrollado con Django, Open-Meteo y ArXiv | TuClima
    </footer>

<script>
    function usarGPS() {
        // 1. Preguntamos si el navegador tiene GPS
        if (navigator.geolocation) {
            // 2. Pedimos la posici√≥n
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    // √âXITO: Obtenemos coordenadas
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    
                    // 3. Recargamos la p√°gina mandando los datos a tu Python
                    window.location.href = "/?lat=" + lat + "&lon=" + lon;
                },
                function(error) {
                    // ERROR: Si el usuario bloque√≥ el permiso
                    alert("‚ö†Ô∏è Error: No pudimos acceder a tu ubicaci√≥n. Verifica los permisos del navegador.");
                }
            );
        } else {
            alert("Tu navegador no soporta geolocalizaci√≥n.");
        }
    }
</script>

<style>
        /* CSS DEL FOOTER */
        .site-footer {
            background-color: #020617; /* Fondo casi negro */
            border-top: 1px solid rgba(56, 189, 248, 0.3);
            padding: 60px 20px 30px 20px;
            margin-top: 80px;
            font-family: 'Segoe UI', sans-serif;
            color: #94a3b8;
            font-size: 0.9em;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 40px;
            margin-bottom: 50px;
        }

        .footer-col h4 {
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 25px;
            font-size: 1.0em;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(56, 189, 248, 0.3);
            display: inline-block;
            padding-bottom: 5px;
        }

        .footer-col p { line-height: 1.6; opacity: 0.8; font-size: 0.95em; }

        .footer-links { list-style: none; padding: 0; margin: 0; }
        .footer-links li { margin-bottom: 12px; }
        .footer-links a {
            text-decoration: none;
            color: #94a3b8;
            transition: 0.3s;
            display: flex; align-items: center; gap: 10px;
        }
        .footer-links a:hover {
            color: #38bdf8;
            transform: translateX(5px);
        }

        .api-tag {
            font-size: 0.75em;
            background: rgba(255,255,255,0.05);
            padding: 3px 8px;
            border-radius: 4px;
            border: 1px solid rgba(255,255,255,0.1);
            color: #64748b;
            margin-left: auto;
        }

        /* BARRA INFERIOR LEGAL */
        .footer-bottom {
            padding-top: 25px;
            border-top: 1px solid rgba(255,255,255,0.05);
            font-size: 0.8em;
            color: #64748b;
            display: flex;
            justify-content: space-between; /* Separa texto izquierda y links derecha */
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .legal-links a {
            color: #64748b; text-decoration: none; margin-left: 15px; transition: 0.3s;
        }
        .legal-links a:hover { color: #38bdf8; }

        .f-icon { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; opacity: 0.9; }

        @media (max-width: 768px) {
            .footer-bottom { flex-direction: column; text-align: center; }
            .legal-links a { margin: 0 8px; }
        }
    </style>

    <footer class="site-footer">
        <div class="footer-content">
            
            <div class="footer-col">
                <h4 style="color: #38bdf8; border-color: #38bdf8;">TuClima Pro</h4>
                <p>
                   <strong>Suite de inteligencia clim√°tica con Motor de B√∫squeda Global.</strong><br>
    Potenciamos 4 sectores cr√≠ticos (Agro, Naval, A√©reo, Energ√≠as) integrando telemetr√≠a directa de <strong>NASA y OpenWeatherMap</strong>.
    <br><br>
    Toma de decisiones basada en datos atmosf√©ricos reales y precisos.
                </p>
                
            </div>

            <div class="footer-col">
                <h4>MODOS PRO</h4>
                <ul class="footer-links">
                    <li>
                        <a href="#"> <svg class="f-icon" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"/><path d="M8.5 8.5a4 4 0 0 1 5.66 0"/><path d="M10 10a2 2 0 0 1 2.83 0"/></svg>
                            Modo Agro
                        </a>
                    </li>
                    <li>
                        <a href="#"> <svg class="f-icon" viewBox="0 0 24 24"><circle cx="12" cy="5" r="3"/><line x1="12" y1="22" x2="12" y2="8"/><path d="M5 12H2a10 10 0 0 0 20 0h-3"/></svg>
                            Modo Naval
                        </a>
                    </li>
                    <li>
                        <a href="#"> <svg class="f-icon" viewBox="0 0 24 24"><path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.3c.4-.2.6-.6.5-1.1z"/></svg>
                            Modo A√©reo
                        </a>
                    </li>
                    <li>
                        <a href="#"> <svg class="f-icon" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                            Modo Energ√≠as
                        </a>
                    </li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>CIENCIA</h4>
                <ul class="footer-links">
                    <li>
                        <a href="#"> 
                            <svg class="f-icon" viewBox="0 0 24 24"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></svg>
                            Mapas & Radar
                        </a>
                    </li>
                    <li>
                        <a href="#"> 
                            <svg class="f-icon" viewBox="0 0 24 24"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>
                            Papers & ArXiv
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <svg class="f-icon" viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>
                            Comparador Cient√≠fico
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'espacio' %}">
                            <svg class="f-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><path d="M12 1v2"/><path d="M12 21v2"/><path d="M4.22 4.22l1.42 1.42"/><path d="M18.36 18.36l1.42 1.42"/><path d="M1 12h2"/><path d="M21 12h2"/></svg>
                            Meteorolog√≠a Espacial
                        </a>
                    </li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>PLATAFORMA</h4>
                <ul class="footer-links">
                    <li>
                        <a href="{% url 'home' %}">
                            <svg class="f-icon" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                            Inicio / Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <svg class="f-icon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                            Centro de Ayuda
                        </a>
                    </li>
                </ul>
                
                <div style="margin-top: 25px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; font-size: 0.85em;">
                        <span style="opacity:0.6;">Datos:</span>
                        <span class="api-tag">OpenWeather</span>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.85em;">
                        <span style="opacity:0.6;">Versi√≥n:</span>
                        <span class="api-tag">v2.1 Stable</span>
                    </div>
                </div>
            </div>

        </div>

        <div class="footer-bottom">
            <div>
                &copy; {% now "Y" %} TuClima Labs. Todos los derechos reservados.
            </div>
            <div class="legal-links">
    <a href="{% url 'legal' %}">Privacidad</a>
    <a href="{% url 'legal' %}">T√©rminos</a>
    <a href="{% url 'legal' %}">Cookies</a>
</div>
        </div>
    </footer>



<script type="text/javascript" src="https://cdn.weglot.com/weglot.min.js"></script>
    <script>
        Weglot.initialize({
            api_key: 'wg_169c193b22e7a117be85a2f56113ab415', // <--- TU CLAVE REAL
            hide_switcher: true,  // Ocultamos el bot√≥n feo original
            auto_switch: false    // Lo ponemos en manual para probar
        });
    </script>

    
</body>
</html>